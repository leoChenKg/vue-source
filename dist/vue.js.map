{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\r\n  constructor(data) {\r\n    // Object.defineProperty 只能劫持对象中已经存在的属性\r\n    this.walk(data)\r\n    window.data = data\r\n  }\r\n\r\n  // 循环对象，对属性依次劫持\r\n  walk(data) {\r\n    Object.keys(data).forEach(key => defineReactive(data, key, data[key]))\r\n  }\r\n}\r\n\r\n// 数据劫持功能的函数\r\nexport function defineReactive(target, key, value) {\r\n  // 如果当前值是对象则 继续递归劫持其属性\r\n  observe(value)\r\n  // 劫持数据\r\n  Object.defineProperty(target, key, {\r\n    get() {\r\n      return value\r\n    },\r\n    set(newVal) {\r\n      if (newVal === value) return\r\n      console.log('数据改变了，去更新页面！')\r\n      value = newVal\r\n    }\r\n  })\r\n}\r\n\r\nexport default function observe(data) {\r\n  // 数据劫持\r\n\r\n  if (typeof data !== 'object' || data == null) {\r\n    return // 不是对象并进行数据劫持\r\n  }\r\n\r\n  // 一个对象只需要劫持一次，判断对象是否被劫持过，可以添加一个实例，用实例来判断是否被劫持过\r\n  return new Observer(data)\r\n}\r\n","import observe from './observe/index'\r\nexport default function initState(vm) {\r\n  const opts = vm.$options\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n}\r\n// 处理 options 上的 data\r\nfunction initData(vm) {\r\n  let data = vm.$options.data // data 可能是函数也可能是对象\r\n  data = typeof data === 'function' ? data.call(this) : data\r\n\r\n  // 在 Vue 实实力上加入 _data 属性其值就是 data\r\n  vm._data = data\r\n  // 把 vm._data.xxx  代理成 vm.xxx\r\n  proxy(vm, vm._data)\r\n  // 劫持数据\r\n  observe(data)\r\n}\r\n\r\n// 把 vm._data.xxx  代理成 vm.xxx\r\nfunction proxy(from, target) {\r\n  Object.keys(target).forEach(key => {\r\n    Object.defineProperty(from, key, {\r\n      get() {\r\n        return target[key]\r\n      },\r\n      set(newVal) {\r\n        target[key] = newVal\r\n      }\r\n    })\r\n  })\r\n}\r\n","import initState from './state'\r\nfunction initMixin(Vue) {\r\n  // 用于初始化操作\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this\r\n    // vue 实例的方法或属性前面有 $\r\n    // 代表用户传过来的配置选项，把它放在全局上，\r\n    // 这样其他实例方法都能访问\r\n    this.$options = options\r\n\r\n    // 初始化状态\r\n    initState(vm)\r\n  }\r\n}\r\n\r\nexport default initMixin\r\n","import initMixin from './init'\r\nfunction Vue(options) {\r\n    debugger\r\n  this._init(options)\r\n}\r\ninitMixin(Vue) // 扩展了 init 方法\r\nexport default Vue\r\n"],"names":["Observer","data","walk","window","Object","keys","forEach","key","defineReactive","target","value","observe","defineProperty","get","set","newVal","console","log","initState","vm","opts","$options","initData","call","_data","proxy","from","initMixin","Vue","prototype","_init","options"],"mappings":"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"}